<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YoSinTV - Cricket | Football | Playing XI | Match Preview</title>
    <!-- Updated standard CDN for Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href='/favico.png' rel='icon' type='image/x-icon'/>
   <link rel="stylesheet" href="/style.css">
    
    <!-- CRITICAL FIX: Added /adsbygoogle.js to the source URL to ensure the AdSense library loads correctly -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5525538810839147" crossorigin="anonymous"></script>
    
</head>
<body class="bg-gray-100 text-gray-900">

<!-- Header and Logo -->
<header>
    <div class="header-container">
        <a href="https://www.yosin-tv.net/">
            <img src="https://web.cricfoot.net/logo.png" alt="YoSinTV" style="height:65px;">
        </a>
        <label class="toggle">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
        </label>
    </div>
</header>

    
<main style="padding-top: 78px;">
    <center class="my-3">
        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5525538810839147"
            data-ad-slot="4345862479" data-ad-format="auto" data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </center>

    <div class="match-schedule-container"> 
        <h2 class="league-title"> Upcoming Football Matches</h2>
        <div id="cricket-list" class="match-schedule-list">
        <a href="/?ads=link" class="blinking-dot-container" style="display:inline-flex;align-items:center;gap:10px;font-family:Arial,sans-serif;font-size:16px;font-weight:bold;text-decoration:none;color:#333;transition:color 0.3s ease;width:100%;margin:0;padding:10px 0;text-align:center;box-sizing:border-box;border:2px solid #333;border-radius:10px;justify-content:center;" onmouseover="this.style.color='#ff0000'" onmouseout="this.style.color='#333'"><span style="width:10px;height:10px;background-color:red;border-radius:50%;animation:blink 1s infinite;"></span> Watch Cricket Matches: Click Here</a><style>@keyframes blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}</style>
        <div id="cricket-list" class="match-schedule-list">
            <!-- Match cards will be inserted here. Removed initial loading text for a natural load. -->
        </div>        </div>

        <center class="my-5">
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5525538810839147"
                data-ad-slot="4345862479" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </center>
    </div>

<!-- DMCA and Footer Sections -->
    <section class="dmca-section">
        <h2 class="text-2xl font-bold mb-3">YoSinTV - DMCA Notice</h2>
        <p class="text-sm leading-relaxed">YoSinTV Doesn't host any media content on it own Site. Our site visitors might use external or third parties services to show content, (Example: Embedding media from sites like Bet365, Dailymotion , Streamable etc ..) We Notify all copyright owners, to discover that the links and media shared by visitors and contained within this site are hosted somewhere else on the web or embedded from other various sites like above.</p>
    </section>

    <footer class="footer text-sm">
        <a href="#about" class="text-blue-600 hover:underline mx-2">About</a> •
        <a href="#contact" class="text-blue-600 hover:underline mx-2">Contact</a> •
        <a href="#privacy" class="text-blue-600 hover:underline mx-2">Privacy Policy</a>
    </footer>
</main>

<script>
    let allMatches = [];
    let updateIntervalId;

    // Dark Mode Logic (Kept for user's preference)
    const toggle = document.getElementById('darkModeToggle');
    // Set initial state
    const updateTheme = (isDark) => {
        if (isDark) {
             // We only need to toggle the 'dark' class here.
             // The rest of the styling is handled by the CSS using .dark prefix.
             document.body.classList.add('dark', 'bg-gray-900', 'text-gray-100');
             document.body.classList.remove('bg-gray-100', 'text-gray-900');
        } else {
             document.body.classList.remove('dark', 'bg-gray-900', 'text-gray-100');
             document.body.classList.add('bg-gray-100', 'text-gray-900');
        }
    };

    if (localStorage.getItem('darkMode') === 'true') {
        updateTheme(true);
        toggle.checked = true;
    } else {
        updateTheme(false);
    }
    
    toggle.addEventListener('change', () => {
        const isChecked = toggle.checked;
        updateTheme(isChecked);
        localStorage.setItem('darkMode', isChecked);
    });

    /**
     * Formats an ISO date string into a readable local time string (e.g., 6:30 PM).
     * This also removes any risk of displaying 'undefined'.
     */
    function formatMatchTime(isoString) {
        try {
            const date = new Date(isoString);
            if (isNaN(date)) return 'Time TBD';

            const timeOptions = { hour: 'numeric', minute: '2-digit', hour12: true };
            return new Intl.DateTimeFormat(undefined, timeOptions).format(date);
        } catch (e) {
            return 'Time TBD';
        }
    }

    /**
     * Updates the text content and class of the countdown/status elements only.
     * This runs every second to prevent continuous DOM re-rendering (flicker).
     */
    function updateCountdownDisplay() {
        const now = Date.now();
        
        document.querySelectorAll('.match-status').forEach(el => {
            const start = new Date(el.dataset.time).getTime();
            const duration = (parseInt(el.dataset.duration) || 2) * 3600000;
            const end = start + duration;

            if (now >= end) {
                // Match is Over (Final Time)
                el.textContent = 'END';
                if (!el.classList.contains('match-status-over')) {
                     el.className = 'match-status match-status-over';
                }
            } else if (now >= start) {
                // Match is Live
                el.textContent = 'LIVE';
                if (!el.classList.contains('match-status-live')) {
                    el.className = 'match-status match-status-live';
                }
            } else {
                // Match is Upcoming (Countdown)
                const diff = start - now;
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                
                let countdownText = '';
                if (diff < 0) {
                     countdownText = 'Starting Soon';
                } else if (d > 0) {
                    countdownText = `${d}d ${h}h`;
                } else if (h > 0) {
                    countdownText = `${h}h ${m}m`;
                } else {
                    const s = Math.floor((diff % (1000 * 60)) / 1000);
                    countdownText = `${m}m ${s}s`;
                }
                
                el.textContent = countdownText;
                if (!el.classList.contains('match-status-countdown')) {
                    el.className = 'match-status match-status-countdown';
                }
            }
        });
    }

    // Generates the match card HTML
    function createCard(m) {
        // --- Added safe property access to prevent 'undefined' ---
        const detailsUrl = m.details_url || '#';
        const competition = m.competition || ''; // Use empty string as fallback
        const team1Name = m.team1 || 'Home Team TBD';
        const team2Name = m.team2 || 'Away Team TBD';
        
        const placeholderImg = "https://placehold.co/48x48/ccc/333?text=L";
        // Use safe fallback for logos as well
        const team1Logo = m.team1_logo || placeholderImg;
        const team2Logo = m.team2_logo || placeholderImg;
        
        const logoOnError = `this.onerror=null;this.src='${placeholderImg}';`;
        
        const localTime = formatMatchTime(m.start || m.match_time);

        // Conditional rendering of the competition header (Match Details text removed)
        // If competition is empty, the div is not rendered at all.
        const competitionHeader = competition ? 
            `<div class="match-header">${competition}</div>` : 
            '';

        const a = document.createElement('a');
        a.href = detailsUrl; // Use safe URL
        a.className = 'match-card';
        a.target = '_blank';
        a.dataset.time = m.start || m.match_time;
        a.dataset.duration = m.duration || 2;
        
        a.innerHTML = `
            <div class="match-card-content">
                <!-- Top Row: Competition/Match Date (Context) -->
                ${competitionHeader}

                <!-- Middle Row: Teams and Status (The main, centered row) -->
                <div class="match-row-teams">
                    <!-- Home Team (Left, Content aligned right) -->
                    <div class="match-team home">
                        <p class="match-team-name">${team1Name}</p>
                        <img src="${team1Logo}" alt="${team1Name}" onerror="${logoOnError}">
                    </div>
                    
                    <!-- Status/Center (Time above Countdown) -->
                    <div class="match-center">
                        <p class="match-local-time">${localTime}</p> 
                        <p class="match-status" data-time="${m.start || m.match_time}" data-duration="${m.duration || 2}">Loading...</p>
                    </div>

                    <!-- Away Team (Right, Content aligned left) -->
                    <div class="match-team away">
                        <img src="${team2Logo}" alt="${team2Name}" onerror="${logoOnError}">
                        <p class="match-team-name">${team2Name}</p>
                    </div>
                </div>
            </div>
        `;
        return a;
    }

    /**
     * Creates the mobile-only ad element with the user-specified slot ID.
     * UPDATED to use the 320x50 fixed size ad unit (slot 8381900703).
     */
    function createAdElement() {
        const adContainer = document.createElement('div');
        // 'block md:hidden' ensures it only displays on mobile screens (up to 768px).
        // Added flex justify-center to properly center the fixed 320px ad.
        adContainer.className = 'my-5 flex justify-center block md:hidden'; 
        adContainer.innerHTML = ` `;
        return adContainer;
    }

    // UPDATED: Inserts mobile ads after every 3rd card.
    function renderMatches() {
        const list = document.getElementById('cricket-list');
        list.innerHTML = ''; 
        
        allMatches.forEach((match, index) => {
            // 1. Append the match card
            list.appendChild(createCard(match));

            // 2. Check if it's the 3rd, 6th, 9th, etc. card, and not the last card
            if ((index + 1) % 0 === 0 && index < allMatches.length - 1) { 
                const adElement = createAdElement();
                list.appendChild(adElement);

                // Now, push the ad to AdSense so it can request content
                try {
                    (window.adsbygoogle = window.adsbygoogle || []).push({});
                } catch (e) {
                    console.error("AdSense push failed:", e);
                }
            }
        });
    }
    
    /**
     * Calculates sort priority, sorts the matches array, and renders the list once.
     * This function should only be called on initial load.
     */
    function sortAndInitialRender(matchesArray) {
        const now = Date.now();
        
        // 1. Calculate sorting priority and value
        allMatches = matchesArray.map(m => {
            const startTime = new Date(m.start || m.match_time).getTime();
            const duration = (parseInt(m.duration) || 2) * 3600000; 
            const endTime = startTime + duration;
    
            if (now >= startTime && now < endTime) {
                m.sortPriority = 1; // Live/In-Progress
                m.sortValue = startTime; 
            } else if (now < startTime) {
                m.sortPriority = 2; // Upcoming
                m.sortValue = startTime;
            } else {
                m.sortPriority = 3; // Finished
                m.sortValue = endTime;
            }
            return m;
        });
    
        // 2. Sort the array
        allMatches.sort((a, b) => {
            if (a.sortPriority !== b.sortPriority) return a.sortPriority - b.sortPriority;
            return a.sortValue - b.sortValue; 
        });
    
        // 3. Render the full match list structure once
        renderMatches(); 
    }

    // Loads data from the API and initiates rendering
    async function loadMatches() {
        if (updateIntervalId) clearInterval(updateIntervalId); 

        // UPDATED: Changed API endpoint to football.json
        const apiUrl = 'https://yosintv-api.pages.dev/api/football.json'; 
        const list = document.getElementById('cricket-list');
        // Removed explicit loading message for natural loading behavior
        list.innerHTML = ''; 

        try {
            const res = await fetch(apiUrl);
            if (!res.ok) {
                throw new Error(`API failed with status: ${res.status}.`);
            }
            
            const data = await res.json();
            let matchesArray = [];

            if (Array.isArray(data) && data.length > 0 && Array.isArray(data[0]?.matches)) {
                matchesArray = data[0].matches;
            } else if (data && Array.isArray(data.matches)) {
                matchesArray = data.matches;
            } else if (Array.isArray(data)) {
                 matchesArray = data;
            } 

            if (matchesArray.length === 0) {
                list.innerHTML = '<p class="text-center text-xl font-semibold text-gray-500 py-10">No upcoming matches found.</p>';
                return;
            }
            
            // Initial sort and render
            sortAndInitialRender(matchesArray);
            
            // Start the non-flickering countdown timer (runs every second)
            updateCountdownDisplay();
            updateIntervalId = setInterval(updateCountdownDisplay, 1000);
            
        } catch (e) {
            console.error(`Error loading matches: ${e.message}`);
            list.innerHTML = '<p class="text-center text-xl font-semibold text-red-600 py-10">❌ Match List are loading, Please Wait !! </p>';
            return;
        }
    }


    document.addEventListener('DOMContentLoaded', loadMatches);
</script>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <div id='fixedban' class='fixed bottom-0 left-1/2 -translate-x-1/2 z-[999]'>
    <div class='relative w-[300px] h-[250px] bg-white rounded-lg shadow-xl border border-gray-200'>
      <button id='close-fixedban' class='absolute left-1/2 -translate-x-1/2 top-3 text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors duration-200 cursor-pointer z-[1000]'>Close</button>
      <div class='w-[300px] h-[250px] overflow-hidden pt-8'>
        <ins class='adsbygoogle inline-block w-[300px] h-[250px]' data-ad-client='ca-pub-5525538810839147' data-ad-slot='5912194004'></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </div>
  </div>
    
  <script type='text/javascript'>
    $(document).ready(function() {
      $('#close-fixedban').click(function() { $('#fixedban').hide(90); });
    });
  </script>

           <!-- BEGIN: Powered by Supercounters.com -->
        <div style="position:fixed;top:0;left:0;width:100%;height:1px;overflow:hidden;visibility:hidden;z-index:9999;">
            <script type="text/javascript" src="//widget.supercounters.com/ssl/online_i.js"></script>
            <script type="text/javascript">sc_online_i(1725898,,"ffffff","e61c1c");</script>
            <br><noscript><a href="https://www.supercounters.com/">free online counter</a></noscript>
        </div>
    
</body>
</html>
